<%# app/views/incoming_deliveries/index.html.erb %>
<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h5 class="mb-0">
      <% if @project %>
        Deliveries for <%= @project.name %>
      <% else %>
        All Deliveries
      <% end %>
    </h5>
    <div>
      <%= link_to 'New Delivery',
          new_incoming_delivery_path(project_id: @project&.id),
          class: 'btn btn-primary btn-sm' %>
    </div>
  </div>

  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>Order Number</th>
            <th>Delivery Date</th>
            <th>Supplier</th>
            <th>Project</th>
            <th>Items</th>
            <th class="text-end">Actions</th>
          </tr>
        </thead>

        <tbody>
          <% @incoming_deliveries.each do |delivery| %>
            <tr>
              <td><%= delivery.order_number %></td>
              <td><%= delivery.delivery_date.strftime("%Y-%m-%d") %></td>
              <td><%= delivery.supplier_name %></td>
              <td><%= delivery.project.name %></td>
              <td><%= delivery.delivery_items.count %></td>
              <td class="text-end">
                <%= link_to 'View', incoming_delivery_path(delivery),
                    class: 'btn btn-sm btn-info' %>
                <%= link_to 'Edit', edit_incoming_delivery_path(delivery),
                    class: 'btn btn-sm btn-primary' %>
                <%= button_to 'Delete', incoming_delivery_path(delivery),
                    method: :delete,
                    class: 'btn btn-sm btn-danger',
                    form: { style: 'display: inline' },
                    data: { confirm: 'Are you sure?' } %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
